xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.1")
lines(1-fit2.roc$specificities, fit2.roc$sensitivities, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1 AUC=", round(fit1.roc$auc,2)),
paste0("fit2 AUC=", round(fit2.roc$auc, 2))),
col=c("blue", "red"),
lty=1)
# neg pred vs fit1 threshold
plot(fit1.roc$thresholds, 1-fit1.roc$specificities,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.2")
lines(1-fit2.roc$specificities, fit2.roc$sensitivities, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1 AUC=", round(fit1.roc$auc,2)),
paste0("fit2 AUC=", round(fit2.roc$auc, 2))),
col=c("blue", "red"),
lty=1)
# pos pred vs fit2 threshold
plot(fit1.roc$thresholds, 1-fit1.roc$specificities,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.3")
lines(1-fit2.roc$specificities, fit2.roc$sensitivities, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1 AUC=", round(fit1.roc$auc,2)),
paste0("fit2 AUC=", round(fit2.roc$auc, 2))),
col=c("blue", "red"),
lty=1)
# neg pred vs fit2 threshold
plot(fit1.roc$thresholds, 1-fit1.roc$specificities,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.4")
lines(1-fit2.roc$specificities, fit2.roc$sensitivities, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1 AUC=", round(fit1.roc$auc,2)),
paste0("fit2 AUC=", round(fit2.roc$auc, 2))),
col=c("blue", "red"),
lty=1)
# pos pred vs fit1 threshold
plot(fit1.roc$thresholds, 1-fit1.roc$specificities,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.1")
lines(fit1.roc$thresholds, fit1.roc$sensitivities, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1 AUC=", round(fit1.roc$auc,2)),
paste0("fit2 AUC=", round(fit2.roc$auc, 2))),
col=c("blue", "red"),
lty=1)
# neg pred vs fit1 threshold
plot(fit1.roc$thresholds, 1-fit1.roc$specificities,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.2")
lines(1-fit2.roc$specificities, fit2.roc$sensitivities, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1 AUC=", round(fit1.roc$auc,2)),
paste0("fit2 AUC=", round(fit2.roc$auc, 2))),
col=c("blue", "red"),
lty=1)
# pos pred vs fit2 threshold
plot(fit1.roc$thresholds, 1-fit1.roc$specificities,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.3")
lines(1-fit2.roc$specificities, fit2.roc$sensitivities, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1 AUC=", round(fit1.roc$auc,2)),
paste0("fit2 AUC=", round(fit2.roc$auc, 2))),
col=c("blue", "red"),
lty=1)
# neg pred vs fit2 threshold
plot(fit1.roc$thresholds, 1-fit1.roc$specificities,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.4")
lines(1-fit2.roc$specificities, fit2.roc$sensitivities, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1 AUC=", round(fit1.roc$auc,2)),
paste0("fit2 AUC=", round(fit2.roc$auc, 2))),
col=c("blue", "red"),
lty=1)
# pos pred vs fit1 threshold
plot(fit1.roc$thresholds, fit1.positive.pred,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.1")
names(fit1.roc)
# fit1 threshold pos pred
names(fit1.roc)
plot(fit1.roc$thresholds, fit1.positive.pred,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. False Postive",
sub = "Figure 4.1")
confusionMatrix(data = as.factor(fit1.pred.5),
reference = fram_data$HD,
positive = levels(fram_data$HD)[2])
confusionMatrix(data = as.factor(fit1.pred.5),
reference = hd_data.f$HD,
positive = levels(fram_data$HD)[2])
confusionMatrix(data = as.factor(fit1.pred.5),
reference = hd_data.f$HD,
positive = levels(fram_data$HD)[2])
confusionMatrix(data = as.factor(fit1.pred.5),
reference = hd_data.f$HD,
positive = levels(hd_data.f$HD)[2])
names(fit1.roc)
fit1.roc
str(fit1.roc)
table(fit1.roc)
summary(fit1.roc)
fit1.roc$predictor
fit1.roc$thresholds
View(full_fit)
summary(aic_fit_final)
fit.final.pred.5 <- as.factor(ifelse(aic_fit_final$fitted > .5, "1", "0"))
fit.final.pred.5 <- as.factor(ifelse(aic_fit_final$fitted > .5, "1", "0"))
MCE.bayes.5 <- (10*sum(fit.final.pred.5[hd_data.f$HD == "1"] != "1")
+ sum(fit.final.pred.5[hd_data.f$HD == "0"] != "0"))/length(hd_data.f$HD)
MCE.bayes.5
fit.final.pred.5 <- as.factor(ifelse(aic_fit_final$fitted > .5, "1", "0"))
MCE.final.bayes <- (10*sum(fit.final.pred.5[hd_data.f$HD == "1"] != "1")
+ sum(fit.final.pred.5[hd_data.f$HD == "0"] != "0"))/length(hd_data.f$HD)
MCE.final.bayes
fit.final.pred.5 <- as.factor(ifelse(aic_fit_final$fitted > .5, "1", "0"))
MCE.final.bayes <- (5*sum(fit.final.pred.5[hd_data.f$HD == "1"] != "1")
+ sum(fit.final.pred.5[hd_data.f$HD == "0"] != "0"))/length(hd_data.f$HD)
MCE.final.bayes
fit.final.pred.5 <- as.factor(ifelse(aic_fit_final$fitted > .5, "1", "0"))
MCE.final.bayes <- (10*sum(fit.final.pred.5[hd_data.f$HD == "1"] != "1")
+ sum(fit.final.pred.5[hd_data.f$HD == "0"] != "0"))/length(hd_data.f$HD)
MCE.final.bayes
coords(fit1.roc)
fit.final.pred.5 <- as.factor(ifelse(aic_fit_final$fitted > .09, "1", "0"))
MCE.final.bayes <- (10*sum(fit.final.pred.5[hd_data.f$HD == "1"] != "1")
+ sum(fit.final.pred.5[hd_data.f$HD == "0"] != "0"))/length(hd_data.f$HD)
MCE.final.bayes
coords(fit1.roc, ret="ppv, npv")
coords(fit1.roc, ret="ppv","npv")
coords(fit1.roc, ret="ppv")
fit1.ppv <- coords(fit1.roc, ret="ppv")
fit1.npv <- coords(fit1.roc, ret="npv")
fit2.ppv <- coords(fit2.roc, ret="ppv")
fit2.npv <- coords(fit2.roc, ret="npv")
plot(fit1.roc$thresholds, fit1.ppv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
fit1.ppv
View(fit1.ppv)
coords(fit1.roc)
coords(fit1.roc, ret="threshold")
fit1.roc
View(fit1)
View(fit1.roc)
coords(fit1.roc, ret="threshold")
View(fit1.roc)
fit1.threshold <- coords(fit1.roc, ret="threshold")
fit2.threshold <- coords(fit2.roc, ret="threshold")
fit1.ppv <- coords(fit1.roc, ret="ppv")
fit1.npv <- coords(fit1.roc, ret="npv")
fit2.ppv <- coords(fit2.roc, ret="ppv")
fit2.npv <- coords(fit2.roc, ret="npv")
plot(fit1.threshold, fit1.ppv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
fit1.roc$thresholds
fit1.threshold
table(fit1.threshold)
names(fit1.threshold)
list(fit1.threshold)
table(fit1.threshold)
plot(table(fit1.threshold), table(fit1.ppv),  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
plot.ts(fit1.threshold, fit1.ppv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
plot(fit1.threshold, fit1.ppv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
View(fit1.threshold)
plot(fit1.threshold$threshold, fit1.ppv$ppv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
plot(fit1.threshold$threshold, fit1.ppv$ppv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
plot(fit1.threshold$threshold, fit1.npv$npv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.npv$npv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1 AUC=", round(fit1.roc$auc,2)),
paste0("fit2 AUC=", round(fit2.roc$auc, 2))),
col=c("blue", "red"),
lty=1)
confusionMatrix(data = as.factor(fit1.pred.5),
reference = hd_data.f$HD,
positive = levels(hd_data.f$HD)[2])
fit1.threshold <- coords(fit1.roc, ret="threshold")
fit2.threshold <- coords(fit2.roc, ret="threshold")
fit1.ppv <- coords(fit1.roc, ret="ppv")
fit1.npv <- coords(fit1.roc, ret="npv")
fit2.ppv <- coords(fit2.roc, ret="ppv")
fit2.npv <- coords(fit2.roc, ret="npv")
# ppv
plot(fit1.threshold$threshold, fit1.ppv$ppv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
# npv
plot(fit1.threshold$threshold, fit1.npv$npv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Postive Prediction",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.npv$npv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
confusionMatrix(data = as.factor(fit1.pred.5),
reference = hd_data.f$HD,
positive = levels(hd_data.f$HD)[2])
fit1.threshold <- coords(fit1.roc, ret="threshold")
fit2.threshold <- coords(fit2.roc, ret="threshold")
fit1.ppv <- coords(fit1.roc, ret="ppv")
fit1.npv <- coords(fit1.roc, ret="npv")
fit2.ppv <- coords(fit2.roc, ret="ppv")
fit2.npv <- coords(fit2.roc, ret="npv")
# ppv
plot(fit1.threshold$threshold, fit1.ppv$ppv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Positive Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
# npv
plot(fit1.threshold$threshold, fit1.npv$npv,  col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Negative Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.npv$npv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
plot(fit1.threshold$threshold, fit1.ppv$ppv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Positive Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
plot(fit1.threshold$threshold, fit1.ppv$ppv, type="o", col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Positive Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
confusionMatrix(data = as.factor(fit1.pred.5),
reference = hd_data.f$HD,
positive = levels(hd_data.f$HD)[2])
fit1.threshold <- coords(fit1.roc, ret="threshold")
fit2.threshold <- coords(fit2.roc, ret="threshold")
fit1.ppv <- coords(fit1.roc, ret="ppv")
fit1.npv <- coords(fit1.roc, ret="npv")
fit2.ppv <- coords(fit2.roc, ret="ppv")
fit2.npv <- coords(fit2.roc, ret="npv")
# ppv
plot(fit1.threshold$threshold, fit1.ppv$ppv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Positive Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
# npv
plot(fit1.threshold$threshold, fit1.npv$npv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Negative Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.npv$npv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
plot(t,z)
confusionMatrix(data = as.factor(fit1.pred.5),
reference = hd_data.f$HD,
positive = levels(hd_data.f$HD)[2])
fit1.threshold <- coords(fit1.roc, ret="threshold")
fit2.threshold <- coords(fit2.roc, ret="threshold")
fit1.ppv <- coords(fit1.roc, ret="ppv")
fit1.npv <- coords(fit1.roc, ret="npv")
fit2.ppv <- coords(fit2.roc, ret="ppv")
fit2.npv <- coords(fit2.roc, ret="npv")
# ppv
plot(fit1.threshold$threshold, fit1.ppv$ppv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Positive Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
# npv
plot(fit1.threshold$threshold, fit1.npv$npv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Negative Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.npv$npv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
confusionMatrix(data = as.factor(fit1.pred.5),
reference = hd_data.f$HD,
positive = levels(hd_data.f$HD)[2])
fit1.threshold <- coords(fit1.roc, ret="threshold")
fit2.threshold <- coords(fit2.roc, ret="threshold")
fit1.ppv <- coords(fit1.roc, ret="ppv")
fit1.npv <- coords(fit1.roc, ret="npv")
fit2.ppv <- coords(fit2.roc, ret="ppv")
fit2.npv <- coords(fit2.roc, ret="npv")
# ppv
plot(fit1.threshold$threshold, fit1.ppv$ppv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Positive Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
# npv
plot(fit1.threshold$threshold, fit1.npv$npv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="False Positive",
main = "Thresholds vs. Negative Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.npv$npv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
hd_data.new
predict(aic_fit_final, hd_data.new, type="response")
fit.final.roc<- roc(hd_data.f$HD, aic_fit_final$fitted, plot=T, col="blue")
fit.final.roc$threshold
confusionMatrix(data = as.factor(fit1.pred.5),
reference = hd_data.f$HD,
positive = levels(hd_data.f$HD)[2])
fit1.threshold <- coords(fit1.roc, ret="threshold")
fit2.threshold <- coords(fit2.roc, ret="threshold")
fit1.ppv <- coords(fit1.roc, ret="ppv")
fit1.npv <- coords(fit1.roc, ret="npv")
fit2.ppv <- coords(fit2.roc, ret="ppv")
fit2.npv <- coords(fit2.roc, ret="npv")
# ppv
plot(fit1.threshold$threshold, fit1.ppv$ppv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="ppv",
main = "Thresholds vs. Positive Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
# npv
plot(fit1.threshold$threshold, fit1.npv$npv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="npv",
main = "Thresholds vs. Negative Prediction Values",
sub = "Figure 4.1")
lines(fit2.threshold$threshold, fit2.npv$npv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
fit.all$BestModels
fit.all
fit.final.roc<- roc(hd_data.f$HD, aic_fit_final$fitted, plot=T, col="blue")
fit.final.threshold <- coords(fit.final.roc, ret="threshold")
fit.final.ppv <- coords(fit.final.roc, ret="ppv")
fit.final.npv <- coords(fit.final.roc, ret="npv")
# ppv
plot(fit.final.threshold$threshold, fit.final.ppv$ppv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="ppv",
main = "Thresholds vs. Positive Prediction Values",
sub = "Figure 4.1")
#lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
# npv
plot(fit.final.threshold$threshold, fit.final.npv$npv, type="l", col="blue", pch=16,
xlab="Threshold on prob",
ylab="npv",
main = "Thresholds vs. Negative Prediction Values",
sub = "Figure 4.2")
#lines(fit2.threshold$threshold, fit2.npv$npv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
fit.final.roc<- roc(hd_data.f$HD, aic_fit_final$fitted, plot=T, col="green")
fit.final.threshold <- coords(fit.final.roc, ret="threshold")
fit.final.ppv <- coords(fit.final.roc, ret="ppv")
fit.final.npv <- coords(fit.final.roc, ret="npv")
# ppv
plot(fit.final.threshold$threshold, fit.final.ppv$ppv, type="l", col="green", pch=16,
xlab="Threshold on prob",
ylab="ppv",
main = "Thresholds vs. Positive Prediction Values",
sub = "Figure 4.1")
lines(fit1.threshold$threshold, fit1.ppv$ppv, col="blue", lwd=3)
lines(fit2.threshold$threshold, fit2.ppv$ppv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
# npv
plot(fit.final.threshold$threshold, fit.final.npv$npv, type="l", col="green", pch=16,
xlab="Threshold on prob",
ylab="npv",
main = "Thresholds vs. Negative Prediction Values",
sub = "Figure 4.2")
lines(fit1.threshold$threshold, fit1.ppv$npv, col="blue", lwd=3)
lines(fit2.threshold$threshold, fit2.npv$npv, col="red", lwd=3)
legend("bottomright",
c(paste0("fit1"),
paste0("fit2")),
col=c("blue", "red"),
lty=1)
